<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Catch the Ball — Mini Game</title>
<style>
  :root{--bg:#f6fbff;--card:#fff;--accent:#ff7a7a}
  body{margin:0;font-family:system-ui,Segoe UI,Roboto,Arial; background: url('bg.jpg.png') no-repeat center center fixed;
  background-size: cover; ;display:flex;align-items:center;justify-content:center;height:100vh}
  .wrap{width:100%;max-width:960px;padding:20px}
  .header{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}
  h1{margin:0;font-size:35px;color: rgb(76, 214, 16);}
  .game{display:flex;gap:20px}
  .canvas-wrap{background:var(--card);border-radius:12px;padding:12px;box-shadow:0 8px 30px rgba(112, 234, 36, 0.08)}
  canvas{background:linear-gradient(180deg,#bde7ff,#8fd3f4);border-radius:8px;display:block}
  .sidebar{width:260px;background:var(--card);padding:12px;border-radius:12px}
  .btn{display:inline-block;padding:8px 10px;border-radius:8px;background:linear-gradient(90deg,var(--accent),#ffb199);color:#111;font-weight:700;border:none;cursor:pointer}
  .muted{color:#445766;font-size:14px}
  .stat{margin-top:8px;font-size:16px;font-weight:800}
</style>
</head>
<body>
  <div class="wrap">
    <div class="header">
      <h1>Catch the Ball — Click as many balls as you can!</h1>
      <div>
        <button id="startBtn" class="btn">Start</button>
      </div>
    </div>

    <div class="game">
      <div class="canvas-wrap">
        <canvas id="gameCanvas" width="640" height="420"></canvas>
      </div>
      <aside class="sidebar">
        <div class="muted">Time left</div>
        <div id="time" class="stat">30</div>
        <div class="muted" style="margin-top:12px">Score</div>
        <div id="score" class="stat">0</div>
        <div class="muted" style="margin-top:12px">Misses</div>
        <div id="misses" class="stat">0</div>
        <div style="margin-top:12px">
          <label class="muted">Difficulty</label><br>
          <select id="difficulty">
            <option value="easy">Easy</option>
            <option value="normal" selected>Normal</option>
            <option value="hard">Hard</option>
          </select>
        </div>
        <div style="margin-top:12px">
          <button id="resetBtn" class="btn">Reset</button>
        </div>
        <p class="muted" style="margin-top:12px">Click the colored balls. Each successful click yields +1. Missing a ball (it escapes top) increases miss count.</p>
      </aside>
    </div>
  </div>

<script>
(() => {
  const canvas = document.getElementById('gameCanvas');
  const ctx = canvas.getContext('2d');
  const startBtn = document.getElementById('startBtn');
  const resetBtn = document.getElementById('resetBtn');
  const timeEl = document.getElementById('time');
  const scoreEl = document.getElementById('score');
  const missesEl = document.getElementById('misses');
  const difficulty = document.getElementById('difficulty');

  let balls = [];
  let score = 0, misses = 0;
  let running = false, intervalId = null, spawnInterval = null;
  let timeLeft = 30;

  function rand(min,max){ return Math.random()*(max-min)+min; }
  function spawnBall(){
    const r = rand(14,28);
    const x = rand(r, canvas.width - r);
    const y = canvas.height + r;
    const vy = -rand(1.6,3.2); // speed upwards
    const color = `hsl(${Math.floor(rand(0,360))} 70% 60%)`;
    balls.push({x,y,r,vy,color,alive:true});
  }

  function update(dt){
    // move
    for(const b of balls){
      b.y += b.vy * dt;
    }
    // remove offscreen (escaped)
    for(let i=balls.length-1;i>=0;i--){
      if(balls[i].y + balls[i].r < 0){
        balls.splice(i,1);
        misses++;
        missesEl.innerText = misses;
      }
    }
  }

  function draw(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    // background gradient
    const g = ctx.createLinearGradient(0,0,0,canvas.height);
    g.addColorStop(0,'#bde7ff'); g.addColorStop(1,'#8fd3f4');
    ctx.fillStyle = g;
    ctx.fillRect(0,0,canvas.width,canvas.height);

    // draw balls
    for(const b of balls){
      ctx.beginPath();
      ctx.fillStyle = b.color;
      ctx.shadowColor = "rgba(0,0,0,0.15)";
      ctx.shadowBlur = 8;
      ctx.arc(b.x, b.y, b.r, 0, Math.PI*2);
      ctx.fill();
      ctx.shadowBlur = 0;
    }
  }

  // game loop (fixed time step)
  let last = performance.now();
  function loop(now){
    if(!running) return;
    const dt = (now - last) / 16.666; // approx frames
    last = now;
    update(dt);
    draw();
    requestAnimationFrame(loop);
  }

  // timers & spawn based on difficulty
  function startGame(){
    if(running) return;
    running = true;
    score = 0; misses = 0; timeLeft = 55;
    balls = [];
    scoreEl.innerText = score;
    missesEl.innerText = misses;
    timeEl.innerText = timeLeft;
    last = performance.now();
    requestAnimationFrame(loop);

    // spawn faster with difficulty
    let spawnRate = 900;
    if(difficulty.value === 'easy') spawnRate = 1200;
    if(difficulty.value === 'normal') spawnRate = 850;
    if(difficulty.value === 'hard') spawnRate = 600;

    spawnInterval = setInterval(spawnBall, spawnRate);
    intervalId = setInterval(() => {
      timeLeft--;
      timeEl.innerText = timeLeft;
      if(timeLeft <= 0) stopGame();
    }, 1000);
  }

  function stopGame(){
    running = false;
    clearInterval(spawnInterval);
    clearInterval(intervalId);
    // final draw & message
    draw();
    setTimeout(()=> {
      alert('Game over! Score: ' + score + '\\nMisses: ' + misses);
    }, 80);
  }

  function resetGame(){
    running = false;
    clearInterval(spawnInterval); clearInterval(intervalId);
    balls = []; score = 0; misses = 0; timeLeft = 55;
    scoreEl.innerText = score; missesEl.innerText = misses; timeEl.innerText = timeLeft;
    draw();
  }

  // click detection
  canvas.addEventListener('click', (e) => {
    if(!running) return;
    const rect = canvas.getBoundingClientRect();
    const mx = e.clientX - rect.left;
    const my = e.clientY - rect.top;
    for(let i = balls.length -1; i >= 0; i--){
      const b = balls[i];
      const dx = mx - b.x, dy = my - b.y;
      if(dx*dx + dy*dy <= b.r*b.r){
        // hit
        balls.splice(i,1);
        score++;
        scoreEl.innerText = score;
        // tiny pop animation
        spawnPop(b.x, b.y);
        break;
      }
    }
  });

  function spawnPop(x,y){
    // simple ring effect
    let alpha = 1; let radius = 6;
    const frames = setInterval(()=> {
      ctx.beginPath();
      ctx.strokeStyle = `rgba(255,255,255,${alpha})`;
      ctx.lineWidth = 2;
      ctx.arc(x,y,radius,0,Math.PI*2);
      ctx.stroke();
      alpha -= 0.12;
      radius += 4;
      if(alpha <= 0){ clearInterval(frames); }
    }, 16);
  }

  startBtn.addEventListener('click', startGame);
  resetBtn.addEventListener('click', resetGame);

  // initial draw
  draw();
})();
</script>
</body>
</html>
